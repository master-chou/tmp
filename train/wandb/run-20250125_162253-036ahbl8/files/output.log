Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Total rpe parameters: 1044
Total cpe parameters: 21504
Trainable parameters:
positional_embedding
text_projection
logit_scale
visual.module.class_embedding
visual.module.positional_embedding
visual.module.proj
visual.module.conv1.weight
visual.module.ln_pre.weight
visual.module.ln_pre.bias
visual.module.transformer.resblocks.0.attn.rpe.rpe_table
visual.module.transformer.resblocks.0.attn.in_proj.weight
visual.module.transformer.resblocks.0.attn.in_proj.bias
visual.module.transformer.resblocks.0.attn.out_proj.weight
visual.module.transformer.resblocks.0.attn.out_proj.bias
visual.module.transformer.resblocks.0.ln_1.weight
visual.module.transformer.resblocks.0.ln_1.bias
visual.module.transformer.resblocks.0.mlp.c_fc.weight
visual.module.transformer.resblocks.0.mlp.c_fc.bias
visual.module.transformer.resblocks.0.mlp.c_proj.weight
visual.module.transformer.resblocks.0.mlp.c_proj.bias
visual.module.transformer.resblocks.0.ln_2.weight
visual.module.transformer.resblocks.0.ln_2.bias
visual.module.transformer.resblocks.0.ln_cpe.weight
visual.module.transformer.resblocks.0.ln_cpe.bias
visual.module.transformer.resblocks.0.cpe.conv3d.weight
visual.module.transformer.resblocks.0.cpe.conv3d.bias
visual.module.transformer.resblocks.1.attn.rpe.rpe_table
visual.module.transformer.resblocks.1.attn.in_proj.weight
visual.module.transformer.resblocks.1.attn.in_proj.bias
visual.module.transformer.resblocks.1.attn.out_proj.weight
visual.module.transformer.resblocks.1.attn.out_proj.bias
visual.module.transformer.resblocks.1.ln_1.weight
visual.module.transformer.resblocks.1.ln_1.bias
visual.module.transformer.resblocks.1.mlp.c_fc.weight
visual.module.transformer.resblocks.1.mlp.c_fc.bias
visual.module.transformer.resblocks.1.mlp.c_proj.weight
visual.module.transformer.resblocks.1.mlp.c_proj.bias
visual.module.transformer.resblocks.1.ln_2.weight
visual.module.transformer.resblocks.1.ln_2.bias
visual.module.transformer.resblocks.1.ln_cpe.weight
visual.module.transformer.resblocks.1.ln_cpe.bias
visual.module.transformer.resblocks.1.cpe.conv3d.weight
visual.module.transformer.resblocks.1.cpe.conv3d.bias
visual.module.transformer.resblocks.2.attn.rpe.rpe_table
visual.module.transformer.resblocks.2.attn.in_proj.weight
visual.module.transformer.resblocks.2.attn.in_proj.bias
visual.module.transformer.resblocks.2.attn.out_proj.weight
visual.module.transformer.resblocks.2.attn.out_proj.bias
visual.module.transformer.resblocks.2.ln_1.weight
visual.module.transformer.resblocks.2.ln_1.bias
visual.module.transformer.resblocks.2.mlp.c_fc.weight
visual.module.transformer.resblocks.2.mlp.c_fc.bias
visual.module.transformer.resblocks.2.mlp.c_proj.weight
visual.module.transformer.resblocks.2.mlp.c_proj.bias
visual.module.transformer.resblocks.2.ln_2.weight
visual.module.transformer.resblocks.2.ln_2.bias
visual.module.transformer.resblocks.2.ln_cpe.weight
visual.module.transformer.resblocks.2.ln_cpe.bias
visual.module.transformer.resblocks.2.cpe.conv3d.weight
visual.module.transformer.resblocks.2.cpe.conv3d.bias
visual.module.transformer.resblocks.3.attn.rpe.rpe_table
visual.module.transformer.resblocks.3.attn.in_proj.weight
visual.module.transformer.resblocks.3.attn.in_proj.bias
visual.module.transformer.resblocks.3.attn.out_proj.weight
visual.module.transformer.resblocks.3.attn.out_proj.bias
visual.module.transformer.resblocks.3.ln_1.weight
visual.module.transformer.resblocks.3.ln_1.bias
visual.module.transformer.resblocks.3.mlp.c_fc.weight
visual.module.transformer.resblocks.3.mlp.c_fc.bias
visual.module.transformer.resblocks.3.mlp.c_proj.weight
visual.module.transformer.resblocks.3.mlp.c_proj.bias
visual.module.transformer.resblocks.3.ln_2.weight
visual.module.transformer.resblocks.3.ln_2.bias
visual.module.transformer.resblocks.3.ln_cpe.weight
visual.module.transformer.resblocks.3.ln_cpe.bias
visual.module.transformer.resblocks.3.cpe.conv3d.weight
visual.module.transformer.resblocks.3.cpe.conv3d.bias
visual.module.transformer.resblocks.4.attn.rpe.rpe_table
visual.module.transformer.resblocks.4.attn.in_proj.weight
visual.module.transformer.resblocks.4.attn.in_proj.bias
visual.module.transformer.resblocks.4.attn.out_proj.weight
visual.module.transformer.resblocks.4.attn.out_proj.bias
visual.module.transformer.resblocks.4.ln_1.weight
visual.module.transformer.resblocks.4.ln_1.bias
visual.module.transformer.resblocks.4.mlp.c_fc.weight
visual.module.transformer.resblocks.4.mlp.c_fc.bias
visual.module.transformer.resblocks.4.mlp.c_proj.weight
visual.module.transformer.resblocks.4.mlp.c_proj.bias
visual.module.transformer.resblocks.4.ln_2.weight
visual.module.transformer.resblocks.4.ln_2.bias
visual.module.transformer.resblocks.4.ln_cpe.weight
visual.module.transformer.resblocks.4.ln_cpe.bias
visual.module.transformer.resblocks.4.cpe.conv3d.weight
visual.module.transformer.resblocks.4.cpe.conv3d.bias
visual.module.transformer.resblocks.5.attn.rpe.rpe_table
visual.module.transformer.resblocks.5.attn.in_proj.weight
visual.module.transformer.resblocks.5.attn.in_proj.bias
visual.module.transformer.resblocks.5.attn.out_proj.weight
visual.module.transformer.resblocks.5.attn.out_proj.bias
visual.module.transformer.resblocks.5.ln_1.weight
visual.module.transformer.resblocks.5.ln_1.bias
visual.module.transformer.resblocks.5.mlp.c_fc.weight
visual.module.transformer.resblocks.5.mlp.c_fc.bias
visual.module.transformer.resblocks.5.mlp.c_proj.weight
visual.module.transformer.resblocks.5.mlp.c_proj.bias
visual.module.transformer.resblocks.5.ln_2.weight
visual.module.transformer.resblocks.5.ln_2.bias
visual.module.transformer.resblocks.5.ln_cpe.weight
visual.module.transformer.resblocks.5.ln_cpe.bias
visual.module.transformer.resblocks.5.cpe.conv3d.weight
visual.module.transformer.resblocks.5.cpe.conv3d.bias
visual.module.transformer.resblocks.6.attn.rpe.rpe_table
visual.module.transformer.resblocks.6.attn.in_proj.weight
visual.module.transformer.resblocks.6.attn.in_proj.bias
visual.module.transformer.resblocks.6.attn.out_proj.weight
visual.module.transformer.resblocks.6.attn.out_proj.bias
visual.module.transformer.resblocks.6.ln_1.weight
visual.module.transformer.resblocks.6.ln_1.bias
visual.module.transformer.resblocks.6.mlp.c_fc.weight
visual.module.transformer.resblocks.6.mlp.c_fc.bias
visual.module.transformer.resblocks.6.mlp.c_proj.weight
visual.module.transformer.resblocks.6.mlp.c_proj.bias
visual.module.transformer.resblocks.6.ln_2.weight
visual.module.transformer.resblocks.6.ln_2.bias
visual.module.transformer.resblocks.6.ln_cpe.weight
visual.module.transformer.resblocks.6.ln_cpe.bias
visual.module.transformer.resblocks.6.cpe.conv3d.weight
visual.module.transformer.resblocks.6.cpe.conv3d.bias
visual.module.transformer.resblocks.7.attn.rpe.rpe_table
visual.module.transformer.resblocks.7.attn.in_proj.weight
visual.module.transformer.resblocks.7.attn.in_proj.bias
visual.module.transformer.resblocks.7.attn.out_proj.weight
visual.module.transformer.resblocks.7.attn.out_proj.bias
visual.module.transformer.resblocks.7.ln_1.weight
visual.module.transformer.resblocks.7.ln_1.bias
visual.module.transformer.resblocks.7.mlp.c_fc.weight
visual.module.transformer.resblocks.7.mlp.c_fc.bias
visual.module.transformer.resblocks.7.mlp.c_proj.weight
visual.module.transformer.resblocks.7.mlp.c_proj.bias
visual.module.transformer.resblocks.7.ln_2.weight
visual.module.transformer.resblocks.7.ln_2.bias
visual.module.transformer.resblocks.7.ln_cpe.weight
visual.module.transformer.resblocks.7.ln_cpe.bias
visual.module.transformer.resblocks.7.cpe.conv3d.weight
visual.module.transformer.resblocks.7.cpe.conv3d.bias
visual.module.transformer.resblocks.8.attn.rpe.rpe_table
visual.module.transformer.resblocks.8.attn.in_proj.weight
visual.module.transformer.resblocks.8.attn.in_proj.bias
visual.module.transformer.resblocks.8.attn.out_proj.weight
visual.module.transformer.resblocks.8.attn.out_proj.bias
visual.module.transformer.resblocks.8.ln_1.weight
visual.module.transformer.resblocks.8.ln_1.bias
visual.module.transformer.resblocks.8.mlp.c_fc.weight
visual.module.transformer.resblocks.8.mlp.c_fc.bias
visual.module.transformer.resblocks.8.mlp.c_proj.weight
visual.module.transformer.resblocks.8.mlp.c_proj.bias
visual.module.transformer.resblocks.8.ln_2.weight
visual.module.transformer.resblocks.8.ln_2.bias
visual.module.transformer.resblocks.8.ln_cpe.weight
visual.module.transformer.resblocks.8.ln_cpe.bias
visual.module.transformer.resblocks.8.cpe.conv3d.weight
visual.module.transformer.resblocks.8.cpe.conv3d.bias
visual.module.transformer.resblocks.9.attn.rpe.rpe_table
visual.module.transformer.resblocks.9.attn.in_proj.weight
visual.module.transformer.resblocks.9.attn.in_proj.bias
visual.module.transformer.resblocks.9.attn.out_proj.weight
visual.module.transformer.resblocks.9.attn.out_proj.bias
visual.module.transformer.resblocks.9.ln_1.weight
visual.module.transformer.resblocks.9.ln_1.bias
visual.module.transformer.resblocks.9.mlp.c_fc.weight
visual.module.transformer.resblocks.9.mlp.c_fc.bias
visual.module.transformer.resblocks.9.mlp.c_proj.weight
visual.module.transformer.resblocks.9.mlp.c_proj.bias
visual.module.transformer.resblocks.9.ln_2.weight
visual.module.transformer.resblocks.9.ln_2.bias
visual.module.transformer.resblocks.9.ln_cpe.weight
visual.module.transformer.resblocks.9.ln_cpe.bias
visual.module.transformer.resblocks.9.cpe.conv3d.weight
visual.module.transformer.resblocks.9.cpe.conv3d.bias
visual.module.transformer.resblocks.10.attn.rpe.rpe_table
visual.module.transformer.resblocks.10.attn.in_proj.weight
visual.module.transformer.resblocks.10.attn.in_proj.bias
visual.module.transformer.resblocks.10.attn.out_proj.weight
visual.module.transformer.resblocks.10.attn.out_proj.bias
visual.module.transformer.resblocks.10.ln_1.weight
visual.module.transformer.resblocks.10.ln_1.bias
visual.module.transformer.resblocks.10.mlp.c_fc.weight
visual.module.transformer.resblocks.10.mlp.c_fc.bias
visual.module.transformer.resblocks.10.mlp.c_proj.weight
visual.module.transformer.resblocks.10.mlp.c_proj.bias
visual.module.transformer.resblocks.10.ln_2.weight
visual.module.transformer.resblocks.10.ln_2.bias
visual.module.transformer.resblocks.10.ln_cpe.weight
visual.module.transformer.resblocks.10.ln_cpe.bias
visual.module.transformer.resblocks.10.cpe.conv3d.weight
visual.module.transformer.resblocks.10.cpe.conv3d.bias
visual.module.transformer.resblocks.11.attn.rpe.rpe_table
visual.module.transformer.resblocks.11.attn.in_proj.weight
visual.module.transformer.resblocks.11.attn.in_proj.bias
visual.module.transformer.resblocks.11.attn.out_proj.weight
visual.module.transformer.resblocks.11.attn.out_proj.bias
visual.module.transformer.resblocks.11.ln_1.weight
visual.module.transformer.resblocks.11.ln_1.bias
visual.module.transformer.resblocks.11.mlp.c_fc.weight
visual.module.transformer.resblocks.11.mlp.c_fc.bias
visual.module.transformer.resblocks.11.mlp.c_proj.weight
visual.module.transformer.resblocks.11.mlp.c_proj.bias
visual.module.transformer.resblocks.11.ln_2.weight
visual.module.transformer.resblocks.11.ln_2.bias
visual.module.transformer.resblocks.11.ln_cpe.weight
visual.module.transformer.resblocks.11.ln_cpe.bias
visual.module.transformer.resblocks.11.cpe.conv3d.weight
visual.module.transformer.resblocks.11.cpe.conv3d.bias
visual.module.ln_post.weight
visual.module.ln_post.bias
transformer.resblocks.0.attn.in_proj_weight
transformer.resblocks.0.attn.in_proj_bias
transformer.resblocks.0.attn.out_proj.weight
transformer.resblocks.0.attn.out_proj.bias
transformer.resblocks.0.ln_1.weight
transformer.resblocks.0.ln_1.bias
transformer.resblocks.0.mlp.c_fc.weight
transformer.resblocks.0.mlp.c_fc.bias
transformer.resblocks.0.mlp.c_proj.weight
transformer.resblocks.0.mlp.c_proj.bias
transformer.resblocks.0.ln_2.weight
transformer.resblocks.0.ln_2.bias
transformer.resblocks.1.attn.in_proj_weight
transformer.resblocks.1.attn.in_proj_bias
transformer.resblocks.1.attn.out_proj.weight
transformer.resblocks.1.attn.out_proj.bias
transformer.resblocks.1.ln_1.weight
transformer.resblocks.1.ln_1.bias
transformer.resblocks.1.mlp.c_fc.weight
transformer.resblocks.1.mlp.c_fc.bias
transformer.resblocks.1.mlp.c_proj.weight
transformer.resblocks.1.mlp.c_proj.bias
transformer.resblocks.1.ln_2.weight
transformer.resblocks.1.ln_2.bias
transformer.resblocks.2.attn.in_proj_weight
transformer.resblocks.2.attn.in_proj_bias
transformer.resblocks.2.attn.out_proj.weight
transformer.resblocks.2.attn.out_proj.bias
transformer.resblocks.2.ln_1.weight
transformer.resblocks.2.ln_1.bias
transformer.resblocks.2.mlp.c_fc.weight
transformer.resblocks.2.mlp.c_fc.bias
transformer.resblocks.2.mlp.c_proj.weight
transformer.resblocks.2.mlp.c_proj.bias
transformer.resblocks.2.ln_2.weight
transformer.resblocks.2.ln_2.bias
transformer.resblocks.3.attn.in_proj_weight
transformer.resblocks.3.attn.in_proj_bias
transformer.resblocks.3.attn.out_proj.weight
transformer.resblocks.3.attn.out_proj.bias
transformer.resblocks.3.ln_1.weight
transformer.resblocks.3.ln_1.bias
transformer.resblocks.3.mlp.c_fc.weight
transformer.resblocks.3.mlp.c_fc.bias
transformer.resblocks.3.mlp.c_proj.weight
transformer.resblocks.3.mlp.c_proj.bias
transformer.resblocks.3.ln_2.weight
transformer.resblocks.3.ln_2.bias
transformer.resblocks.4.attn.in_proj_weight
transformer.resblocks.4.attn.in_proj_bias
transformer.resblocks.4.attn.out_proj.weight
transformer.resblocks.4.attn.out_proj.bias
transformer.resblocks.4.ln_1.weight
transformer.resblocks.4.ln_1.bias
transformer.resblocks.4.mlp.c_fc.weight
transformer.resblocks.4.mlp.c_fc.bias
transformer.resblocks.4.mlp.c_proj.weight
transformer.resblocks.4.mlp.c_proj.bias
transformer.resblocks.4.ln_2.weight
transformer.resblocks.4.ln_2.bias
transformer.resblocks.5.attn.in_proj_weight
transformer.resblocks.5.attn.in_proj_bias
transformer.resblocks.5.attn.out_proj.weight
transformer.resblocks.5.attn.out_proj.bias
transformer.resblocks.5.ln_1.weight
transformer.resblocks.5.ln_1.bias
transformer.resblocks.5.mlp.c_fc.weight
transformer.resblocks.5.mlp.c_fc.bias
transformer.resblocks.5.mlp.c_proj.weight
transformer.resblocks.5.mlp.c_proj.bias
transformer.resblocks.5.ln_2.weight
transformer.resblocks.5.ln_2.bias
transformer.resblocks.6.attn.in_proj_weight
transformer.resblocks.6.attn.in_proj_bias
transformer.resblocks.6.attn.out_proj.weight
transformer.resblocks.6.attn.out_proj.bias
transformer.resblocks.6.ln_1.weight
transformer.resblocks.6.ln_1.bias
transformer.resblocks.6.mlp.c_fc.weight
transformer.resblocks.6.mlp.c_fc.bias
transformer.resblocks.6.mlp.c_proj.weight
transformer.resblocks.6.mlp.c_proj.bias
transformer.resblocks.6.ln_2.weight
transformer.resblocks.6.ln_2.bias
transformer.resblocks.7.attn.in_proj_weight
transformer.resblocks.7.attn.in_proj_bias
transformer.resblocks.7.attn.out_proj.weight
transformer.resblocks.7.attn.out_proj.bias
transformer.resblocks.7.ln_1.weight
transformer.resblocks.7.ln_1.bias
transformer.resblocks.7.mlp.c_fc.weight
transformer.resblocks.7.mlp.c_fc.bias
transformer.resblocks.7.mlp.c_proj.weight
transformer.resblocks.7.mlp.c_proj.bias
transformer.resblocks.7.ln_2.weight
transformer.resblocks.7.ln_2.bias
transformer.resblocks.8.attn.in_proj_weight
transformer.resblocks.8.attn.in_proj_bias
transformer.resblocks.8.attn.out_proj.weight
transformer.resblocks.8.attn.out_proj.bias
transformer.resblocks.8.ln_1.weight
transformer.resblocks.8.ln_1.bias
transformer.resblocks.8.mlp.c_fc.weight
transformer.resblocks.8.mlp.c_fc.bias
transformer.resblocks.8.mlp.c_proj.weight
transformer.resblocks.8.mlp.c_proj.bias
transformer.resblocks.8.ln_2.weight
transformer.resblocks.8.ln_2.bias
transformer.resblocks.9.attn.in_proj_weight
transformer.resblocks.9.attn.in_proj_bias
transformer.resblocks.9.attn.out_proj.weight
transformer.resblocks.9.attn.out_proj.bias
transformer.resblocks.9.ln_1.weight
transformer.resblocks.9.ln_1.bias
transformer.resblocks.9.mlp.c_fc.weight
transformer.resblocks.9.mlp.c_fc.bias
transformer.resblocks.9.mlp.c_proj.weight
transformer.resblocks.9.mlp.c_proj.bias
transformer.resblocks.9.ln_2.weight
transformer.resblocks.9.ln_2.bias
transformer.resblocks.10.attn.in_proj_weight
transformer.resblocks.10.attn.in_proj_bias
transformer.resblocks.10.attn.out_proj.weight
transformer.resblocks.10.attn.out_proj.bias
transformer.resblocks.10.ln_1.weight
transformer.resblocks.10.ln_1.bias
transformer.resblocks.10.mlp.c_fc.weight
transformer.resblocks.10.mlp.c_fc.bias
transformer.resblocks.10.mlp.c_proj.weight
transformer.resblocks.10.mlp.c_proj.bias
transformer.resblocks.10.ln_2.weight
transformer.resblocks.10.ln_2.bias
transformer.resblocks.11.attn.in_proj_weight
transformer.resblocks.11.attn.in_proj_bias
transformer.resblocks.11.attn.out_proj.weight
transformer.resblocks.11.attn.out_proj.bias
transformer.resblocks.11.ln_1.weight
transformer.resblocks.11.ln_1.bias
transformer.resblocks.11.mlp.c_fc.weight
transformer.resblocks.11.mlp.c_fc.bias
transformer.resblocks.11.mlp.c_proj.weight
transformer.resblocks.11.mlp.c_proj.bias
transformer.resblocks.11.ln_2.weight
transformer.resblocks.11.ln_2.bias
token_embedding.weight
ln_final.weight
ln_final.bias
load resumed checkpoint: iter_4000.pth
100%|██████████| 907/907 [31:51<00:00,  2.11s/it]
=====================================
train lr (alpha conv) step 4000: 3.2008000000000003e-06
train lr (other layer) step 4000: 1.6004000000000002e-07
train logit_scale step 4000: 4.605199813842773
train loss step 4000: 0.010255424305796623
=====================================
=====================================
train lr (alpha conv) step 4200: 3.3608e-06
train lr (other layer) step 4200: 1.6804000000000001e-07
train logit_scale step 4200: 4.605199813842773
train loss step 4200: 0.007851051166653633
=====================================
=====================================
train lr (alpha conv) step 4400: 3.5208e-06
train lr (other layer) step 4400: 1.7604e-07
train logit_scale step 4400: 4.605199813842773
train loss step 4400: 0.007409742567688227
=====================================
 51%|█████▏    | 465/907 [10:23<09:52,  1.34s/it]
=====================================
train lr (alpha conv) step 4600: 3.6808e-06
train lr (other layer) step 4600: 1.8404e-07
train logit_scale step 4600: 4.605199813842773
train loss step 4600: 0.007267280947417021
=====================================
=====================================
train lr (alpha conv) step 4800: 3.8408e-06
train lr (other layer) step 4800: 1.9204e-07
train logit_scale step 4800: 4.605199813842773
train loss step 4800: 0.006949068047106266
=====================================
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/aiops/wangzh/zss/AlphaCLIP/train/train/train_neg_rebutal.py", line 762, in <module>
[rank0]:     trainer.train(common_pair=args.common_pair, resume=args.resume, amp=args.amp, warmup_length=args.warmup_length)
[rank0]:   File "/home/aiops/wangzh/zss/AlphaCLIP/train/train/train_neg_rebutal.py", line 683, in train
[rank0]:     loss = self.train_epoch(train_loader, test_loaders, epoch, start_iter=resume_iter, amp=amp)
[rank0]:   File "/home/aiops/wangzh/zss/AlphaCLIP/train/train/train_neg_rebutal.py", line 377, in train_epoch
[rank0]:     self.scheduler(step)
[rank0]:   File "/home/aiops/wangzh/zss/AlphaCLIP/train/scheduler.py", line 25, in _lr_adjuster
[rank0]:     lr = 0.5 * (1 + np.cos(np.pi * e / es)) * base_lr
[rank0]: ZeroDivisionError: float division by zero
